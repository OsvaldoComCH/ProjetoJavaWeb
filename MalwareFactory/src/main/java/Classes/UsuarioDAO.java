package Classes;

import java.sql.*;
//import java.util.ArrayList;

public class UsuarioDAO
{
	private Connection DataBase;
	
	public UsuarioDAO(Connection DataBase)
	{
		this.DataBase = DataBase;
	}
	
	public boolean Insert(Usuario U)
	{
		try
		{
			String Sql = "Insert Into Usuarios(Nome, Email, Senha) Values (?,?,?)";
			PreparedStatement SqlStatement = DataBase.prepareStatement(Sql);
			SqlStatement.setString(1, U.Nome);
			SqlStatement.setString(2, U.Email);
			SqlStatement.setString(3, U.Senha);
			int Lines = SqlStatement.executeUpdate();
			System.out.println("Comandos concluidos com êxito. Linhas afetadas: " + Lines);
			SqlStatement.close();
		}
		catch(Exception E)
		{
			System.out.println("Erro ao adicionar usuario ao banco de dados.");
			E.printStackTrace();
			return false;
		}
		return true;
	}
	public boolean Update(int IDUsuario, String Nome, String Email, String Senha)
	{
		try
		{
			String Sql = "Update Usuarios Set Nome = ?, Email = ?, Senha = ? Where IDUsuario = ?";
			PreparedStatement SqlStatement = DataBase.prepareStatement(Sql);
			SqlStatement.setString(1, Nome);
			SqlStatement.setString(2, Email);
			SqlStatement.setString(3, Senha);
			SqlStatement.setInt(4, IDUsuario);
			int Lines = SqlStatement.executeUpdate();
			System.out.println("Comandos concluidos com êxito. Linhas afetadas: " + Lines);
			SqlStatement.close();
		}
		catch(Exception E)
		{
			System.out.println("Erro ao adicionar usuario ao banco de dados.");
			E.printStackTrace();
			return false;
		}
		return true;
	}
	public boolean Delete(int IDUsuario)
	{
		try
		{
			String Sql = "Delete From Usuarios Where IDUsuario = ?";
			PreparedStatement SqlStatement = DataBase.prepareStatement(Sql);
			SqlStatement.setInt(1, IDUsuario);
			int Lines = SqlStatement.executeUpdate();
			System.out.println("Comandos concluidos com êxito. Linhas afetadas: " + Lines);
			SqlStatement.close();
		}
		catch(Exception E)
		{
			System.out.println("Erro ao remover usuario do banco de dados.");
			E.printStackTrace();
			return false;
		}
		return true;
	}
	public Usuario Select(String Nome, String Senha)
	{
		try
		{
			String Sql = "Select * From Usuarios Where Nome = ? And Senha = ?";
			PreparedStatement SqlStatement = DataBase.prepareStatement(Sql);
			SqlStatement.setString(1, Nome);
			SqlStatement.setString(2, Senha);
			ResultSet rs = SqlStatement.executeQuery();
			if(rs.next())
			{
				Usuario U = new Usuario(rs.getInt(1), rs.getString(2), rs.getString(3), rs.getString(4));
				rs.close();
				SqlStatement.close();
				return U;
			}else
			{
				rs.close();
				SqlStatement.close();
				return null;
			}
		}
		catch(Exception E)
		{
			System.out.println("Erro ao buscar dados do banco.");
			E.printStackTrace();
			return null;
		}
	}
}